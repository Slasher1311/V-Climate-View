<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>V-ClimateView</title>
  <!-- ⚡ Quan trọng: để GitHub Pages hiểu đúng đường dẫn -->
  <base href="/V-Climate-View/">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="static/style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header class="topbar">
    <div class="top-left"><div class="logo">V-ClimateView</div></div>
    <nav class="top-nav">
      <div class="nav-left">
        <span class="menu-icon" onclick="toggleMenu()">☰</span>
      </div>
      <div class="filter-menu-horizontal">
        <button onclick="showSection('weather')">Tổng quan</button>
        <button onclick="showSection('hourly')">Dự báo theo giờ</button>
        <button onclick="showSection('forecast')">Dự báo ngày</button>
        <button onclick="showSection('climate')">Khí hậu</button>
        <button onclick="showSection('trends')">Xu hướng</button>
        <button onclick="showSection('map')">Bản đồ</button>
      </div>
    </nav>
    <div class="top-right">
      <div class="search">
        <input id="searchInput" placeholder="Tìm địa điểm..." onkeyup="handleSearch()"/>
        <button id="searchBtn" onclick="performSearch()"><i class="fas fa-search"></i></button>
        <div id="searchResults" class="search-results" style="display:none"></div>
      </div>
    </div>
  </header>

  <!-- ===== FILTER FORM ===== -->
  <section class="card global-filter">
    <form id="globalFilterForm" method="get">
      <div>
        <label for="province">Tỉnh/Thành:</label>
        <input type="text" name="province" id="province">
      </div>
      <div>
        <label for="station">Tên trạm:</label>
        <input type="text" name="station_name" id="station">
      </div>
      <div>
        <label for="range">Khoảng thời gian:</label>
        <select name="range" id="range">
          <option value="30">30 ngày</option>
          <option value="90">90 ngày</option>
          <option value="365">12 tháng</option>
        </select>
      </div>
      <button type="submit">Áp dụng</button>
    </form>
  </section>

  <!-- ===== WEATHER SECTION ===== -->
  <main class="container">

    <section class="card nowcast-card-modern">
      <div class="weather-main">
        <div class="left">
          <div class="city">Hà Nội</div>
          <div class="temp">30<span class="deg">°C</span></div>
          <div class="desc">Trời quang • Cảm thấy như 32°C</div>
        </div>
        <div class="icon"><i class="fas fa-cloud" style="font-size:48px;color:#fff;"></i></div>
      </div>
      <div class="weather-details">
        <div>Độ ẩm: <strong>60%</strong></div>
        <div>Gió: <strong>15 km/h</strong></div>
        <div>Tầm nhìn: <strong>10 km</strong></div>
        <div>Áp suất: <strong>1010 hPa</strong></div>
        <div>Điểm sương: <strong>20°C</strong></div>
      </div>
    </section>

    <section class="card map-card">
      <h4>Bản đồ thời tiết</h4>
      <div id="map" style="height:320px;border-radius:8px"></div>
    </section>
  </main>

  <!-- ===== JS ===== -->
  <script>
    function showSection(sectionKey){
      const map = {
        'weather': ['nowcast-card-modern'],
        'hourly': ['hourly-card'],
        'forecast': ['daily-forecast'],
        'trends': ['overview-row'],
        'climate': ['climate-info','climate-summary'],
        'map': ['map-card']
      };
      document.querySelectorAll('.card').forEach(sec=>sec.style.display='none');
      (map[sectionKey]||[]).forEach(cls=>{
        const el=document.querySelector('.'+cls);
        if(el) el.style.display='block';
      });
    }

    window.onload = () => {
      const map = L.map('map').setView([21.0285, 105.8542], 6);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    };
  </script>
</body>
</html>
